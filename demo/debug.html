<!DOCTYPE html>
<html>
<head>
    <title>Pong engine debug</title>
    <script src="../build/build.js"></script>
</head>
<body>
<canvas id="demo" width="500" height="500"></canvas>
<script type="text/javascript">
    var PongGame = require("pong-box2d");
    var Box2D = require("pong-box2d/deps/box2dweb-commonjs").Box2D;
    var b2DebugDraw = Box2D.Dynamics.b2DebugDraw;
    var SCALE = 30;


    window.requestAnimFrame = (function(){
        return  window.requestAnimationFrame       ||
                window.webkitRequestAnimationFrame ||
                window.mozRequestAnimationFrame    ||
                window.oRequestAnimationFrame      ||
                window.msRequestAnimationFrame     ||
                function(/* function */ callback, /* DOMElement */ element){
                    window.setTimeout(callback, 1000 / 60);
                };
    })();


    var canvas = document.getElementById("demo");
    var ctx = canvas.getContext("2d");

    var pong = new PongGame(canvas.width, canvas.height, SCALE);

    var debugDraw = new b2DebugDraw();
    debugDraw.SetSprite(document.getElementById("demo").getContext("2d"));
    debugDraw.SetDrawScale(SCALE);
    debugDraw.SetFillAlpha(0.3);
    debugDraw.SetLineThickness(1.0);
    debugDraw.SetFlags(b2DebugDraw.e_shapeBit | b2DebugDraw.e_jointBit);

    // setup debug drawer
    pong._world.SetDebugDraw(debugDraw);

    // start game
    var playerId = pong.joinPlayer();
    pong.playerCommand(playerId, "READY");
    

    // drawing loop
    function update() {
        pong._world.DrawDebugData();
        requestAnimFrame(update);
    }
    requestAnimFrame(update);


</script>

</body>
</html>